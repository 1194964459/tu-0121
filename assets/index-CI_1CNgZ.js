import"./request-BJPJ4U94.js";import{t as g}from"./tracking-CexAsMRI.js";import{d as R,f as v,c as k,a7 as F,o as H,_ as d,k as o,W as a,U as l,V as c,a1 as h,a0 as s,G as p,a4 as i,F as P,a2 as j,S as C,a8 as q}from"./vue-vendor-CWu0UK2c.js";import{h as A,I as y,o as E,p as G,q as L,l as U}from"./ant-design-ZfMx33Ln.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BxAtuLby.js";const z={class:"tracking-page"},J={key:0,class:"tracking-content"},K={class:"order-info"},Q={class:"process-nodes",style:{"margin-top":"24px"}},X={key:0,class:"timeline-section",style:{"margin-top":"24px"}},Z={class:"timeline-item"},$={class:"timeline-title"},ee={class:"timeline-description"},te={class:"timeline-meta"},se={style:{"margin-left":"16px"}},ne=R({__name:"index",setup(ae){const x=F(),m=v(!1),n=v(null),_=v([]),f=k(()=>x.params.id),M=k(()=>n.value?n.value.nodes.map(e=>({title:e.name,description:e.participant,status:b(e.status)})):[]);function b(e){return{pending:"wait",in_progress:"process",completed:"finish",error:"error"}[e]||"wait"}function I(e){return{success:"green",warning:"orange",error:"red",info:"blue"}[e]||"blue"}function S(e){return{success:L,warning:G,error:E,info:y}[e]||y}function T(e){return U(e).format("YYYY-MM-DD HH:mm:ss")}async function w(){if(f.value){m.value=!0;try{const[e,t]=await Promise.all([g.getProcessTracking(f.value),g.getTimeline({orderId:f.value})]);e.code===200&&(n.value=e.data),t.code===200&&(_.value=t.data)}catch(e){console.error("获取追踪信息失败",e),A.error("获取追踪信息失败")}finally{m.value=!1}}}return H(()=>{w()}),(e,t)=>{const u=l("a-descriptions-item"),D=l("a-descriptions"),N=l("a-steps"),V=l("a-timeline-item"),B=l("a-timeline"),O=l("a-spin"),Y=l("a-card");return c(),d("div",z,[o(Y,{title:"全链路流程追踪",bordered:!1},{default:a(()=>[o(O,{spinning:m.value},{default:a(()=>[n.value?(c(),d("div",J,[s("div",K,[t[0]||(t[0]=s("h3",null,"订单信息",-1)),o(D,{column:4,bordered:""},{default:a(()=>[o(u,{label:"订单编号"},{default:a(()=>[p(i(n.value.orderNo),1)]),_:1}),o(u,{label:"当前步骤"},{default:a(()=>[p(i(n.value.currentStep)+" / "+i(n.value.totalSteps),1)]),_:1}),o(u,{label:"完成进度"},{default:a(()=>[p(i(n.value.progress)+"%",1)]),_:1}),o(u,{label:"预计完成日期"},{default:a(()=>[p(i(n.value.estimatedCompletionDate||"-"),1)]),_:1})]),_:1})]),s("div",Q,[t[1]||(t[1]=s("h3",null,"流程节点",-1)),o(N,{current:n.value.currentStep-1,items:M.value},null,8,["current","items"])]),_.value.length>0?(c(),d("div",X,[t[2]||(t[2]=s("h3",null,"操作时间线",-1)),o(B,null,{default:a(()=>[(c(!0),d(P,null,j(_.value,r=>(c(),C(V,{key:r.id,color:I(r.status)},{dot:a(()=>[(c(),C(q(S(r.status))))]),default:a(()=>[s("div",Z,[s("div",$,i(r.title),1),s("div",ee,i(r.description),1),s("div",te,[s("span",null,i(r.participant),1),s("span",se,i(T(r.timestamp)),1)])])]),_:2},1032,["color"]))),128))]),_:1})])):h("",!0)])):h("",!0)]),_:1},8,["spinning"])]),_:1})])}}}),de=W(ne,[["__scopeId","data-v-e2a7d203"]]);export{de as default};
