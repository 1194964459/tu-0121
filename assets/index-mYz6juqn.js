import{_ as M}from"./_plugin-vue_export-helper-C_sFg2ed.js";import{o as F}from"./order-ChNvAzLA.js";import{t as S}from"./tracking-oz6DVUrt.js";import{d as V,r as H,f as v,o as L,b as U,_ as y,k as t,U as n,W as a,V as c,u as _,a1 as u,S as g,a2 as E,G as I,a3 as p,F as W,a5 as J,$ as K}from"./vue-vendor-DGayM9PE.js";import{S as P,k as X,C as Y,G as Z,l as ee}from"./ant-design-Ce2DOam0.js";import"./utils-BsVK5D5E.js";const te={class:"dashboard-page"},ae={class:"timeline-item"},oe={class:"timeline-title"},ne={class:"timeline-description"},se={class:"timeline-meta"},re=V({__name:"index",setup(T){const h=K(),r=H({totalOrders:0,activeOrders:0,completedOrders:0,totalQuantity:0,inTransitQuantity:0,totalVessels:0,activeVessels:0,totalCarriers:0,activeCarriers:0}),f=v(!1),x=v([]),k=v([]),$=[{title:"订单编号",dataIndex:"id",key:"id"},{title:"客户名称",dataIndex:"customerName",key:"customerName"},{title:"数量",key:"quantity",customRender:({record:e})=>"".concat(e.quantity," ").concat(e.unit)},{title:"状态",key:"status"},{title:"操作",key:"action"}];async function b(){try{const e=await S.getStatistics();e.code===200&&Object.assign(r,e.data)}catch(e){console.error("获取统计数据失败",e)}}async function C(){f.value=!0;try{const e=await F.getOrders({page:1,pageSize:5});e.code===200&&(x.value=e.data.list)}catch(e){console.error("获取最近订单失败",e)}finally{f.value=!1}}async function O(){try{const e=await S.getTimeline({});e.code===200&&(k.value=e.data.slice(0,10))}catch(e){console.error("获取时间线失败",e)}}function N(e){h.push("/tracking/".concat(e.id))}function D(e){return{pending:"default",confirmed:"blue",producing:"processing",warehousing:"orange",transporting:"cyan",shipped:"purple",completed:"success",cancelled:"error"}[e]||"default"}function B(e){return{pending:"待确认",confirmed:"已确认",producing:"生产中",warehousing:"集货中",transporting:"运输中",shipped:"已发货",completed:"已完成",cancelled:"已取消"}[e]||e}function z(e){return{success:"green",warning:"orange",error:"red",info:"blue"}[e]||"blue"}function G(e){return ee(e).format("MM-DD HH:mm")}return L(()=>{b(),C(),O();const o=setInterval(()=>{b(),C(),O()},6e4);U(()=>{clearInterval(o)})}),(e,o)=>{const d=n("a-statistic"),l=n("a-card"),i=n("a-col"),w=n("a-row"),Q=n("a-tag"),R=n("a-button"),j=n("a-table"),q=n("a-timeline-item"),A=n("a-timeline");return c(),y("div",te,[t(w,{gutter:16,style:{"margin-bottom":"16px"}},{default:a(()=>[t(i,{span:6},{default:a(()=>[t(l,null,{default:a(()=>[t(d,{title:"总订单数",value:r.totalOrders,"value-style":{color:"#3f8600"}},{prefix:a(()=>[t(_(P))]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{span:6},{default:a(()=>[t(l,null,{default:a(()=>[t(d,{title:"进行中订单",value:r.activeOrders,"value-style":{color:"#1890ff"}},{prefix:a(()=>[t(_(X),{spin:""})]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{span:6},{default:a(()=>[t(l,null,{default:a(()=>[t(d,{title:"总数量（吨）",value:r.totalQuantity,"value-style":{color:"#cf1322"}},{prefix:a(()=>[t(_(Y))]),suffix:a(()=>[...o[0]||(o[0]=[u("span",null,"吨",-1)])]),_:1},8,["value"])]),_:1})]),_:1}),t(i,{span:6},{default:a(()=>[t(l,null,{default:a(()=>[t(d,{title:"在航船舶",value:r.activeVessels,"value-style":{color:"#722ed1"}},{prefix:a(()=>[t(_(Z))]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),t(w,{gutter:16},{default:a(()=>[t(i,{span:16},{default:a(()=>[t(l,{title:"最近订单",bordered:!1},{default:a(()=>[t(j,{columns:$,"data-source":x.value,loading:f.value,pagination:!1,size:"small","row-key":"id"},{bodyCell:a(({column:s,record:m})=>[s.key==="status"?(c(),g(Q,{key:0,color:D(m.status)},{default:a(()=>[I(p(B(m.status)),1)]),_:2},1032,["color"])):s.key==="action"?(c(),g(R,{key:1,type:"link",size:"small",onClick:ue=>N(m)},{default:a(()=>[...o[1]||(o[1]=[I("查看追踪",-1)])]),_:1},8,["onClick"])):E("",!0)]),_:1},8,["data-source","loading"])]),_:1})]),_:1}),t(i,{span:8},{default:a(()=>[t(l,{title:"最新动态",bordered:!1},{default:a(()=>[t(A,{style:{"max-height":"400px","overflow-y":"auto"}},{default:a(()=>[(c(!0),y(W,null,J(k.value,s=>(c(),g(q,{key:s.id,color:z(s.status)},{default:a(()=>[u("div",ae,[u("div",oe,p(s.title),1),u("div",ne,p(s.description),1),u("div",se,p(G(s.timestamp)),1)])]),_:2},1032,["color"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})])}}}),le=M(re,[["__scopeId","data-v-5006562e"]]),ie={class:"home-page"},ce=V({__name:"index",setup(T){return(h,r)=>(c(),y("div",ie,[t(le)]))}}),ge=M(ce,[["__scopeId","data-v-7ce36eec"]]);export{ge as default};
