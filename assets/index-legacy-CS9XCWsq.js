System.register(["./vue-vendor-legacy-CbULZcsl.js","./ant-design-legacy-BYcnYbwI.js","./_plugin-vue_export-helper-legacy-BVIICed7.js","./utils-legacy-DaJqaYpr.js"],function(a,e){"use strict";var l,n,s,t,i,o,p,d,c,r,v,u,h,f,m,g,b,w,x,y,z,F,M,k,C,P,_;return{setters:[a=>{l=a.d,n=a._,s=a.a0,t=a.k,i=a.u,o=a.W,p=a.V,d=a.F,c=a.a1,r=a.S,v=a.a2,u=a.a3,h=a.a4,f=a.a5,m=a.f,g=a.s,b=a.w,w=a.o,x=a.b,y=a.n},a=>{z=a.l,F=a.S,M=a.B,k=a.C,C=a.j},a=>{P=a._},a=>{_=a.t}],execute:function(){var e=document.createElement("style");e.textContent='@charset "UTF-8";.timeline-container[data-v-89be395b]{position:absolute;bottom:20px;left:50%;transform:translate(-50%);display:flex;justify-content:center;z-index:100;width:100%;pointer-events:none}.timeline-wrapper[data-v-89be395b]{display:flex;background:rgba(255,255,255,.9);padding:30px 20px 10px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);pointer-events:auto;min-width:500px;max-width:80%}.custom-steps[data-v-89be395b] .ant-steps-item-container,.clickable-step[data-v-89be395b]{cursor:pointer}.info-panel[data-v-39af6138]{background:rgba(255,255,255,.95);border-radius:4px;box-shadow:0 2px 8px rgba(0,0,0,.15);width:200px;overflow:hidden;pointer-events:auto}.info-panel.merged[data-v-39af6138]{width:240px}.panel-header[data-v-39af6138]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background-color:#f5f5f5;border-bottom:1px solid #e8e8e8}.panel-header h3[data-v-39af6138]{margin:0;font-size:14px;font-weight:600}.close-btn[data-v-39af6138]{padding:0;width:20px;height:20px;display:flex;align-items:center;justify-content:center;color:#999;transition:color .3s;font-size:12px}.close-btn[data-v-39af6138]:hover{color:#333}.panel-content[data-v-39af6138]{padding:10px 12px}.port-panels-wrapper[data-v-568c424d]{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:100;opacity:0;visibility:hidden;transition:opacity .3s ease-in-out,visibility 0s linear .3s}.port-panels-wrapper[data-ready=true][data-v-568c424d]{opacity:1;visibility:visible;transition:opacity .3s ease-in-out,visibility 0s linear 0s}.single-panel[data-v-568c424d]{position:absolute;top:0;left:0;pointer-events:auto;transform:translate(-9999px,-9999px);transition:none}.info-item[data-v-568c424d]{margin-bottom:8px;display:flex;justify-content:space-between;gap:8px;line-height:1.4}.info-item[data-v-568c424d]:last-child{margin-bottom:0}.info-item .label[data-v-568c424d]{color:#666;font-size:12px;white-space:nowrap}.info-item .value[data-v-568c424d]{color:#333;font-size:12px;font-weight:500;text-align:right}.map-visualization[data-v-988cb524]{width:100%;height:100vh;position:relative;overflow:hidden}.map-container[data-v-988cb524]{width:100%;height:100%;position:relative}.zoom-level-display[data-v-988cb524]{position:absolute;top:20px;right:20px;background:rgba(255,255,255,.95);padding:8px 16px;border-radius:4px;box-shadow:0 2px 8px rgba(0,0,0,.15);z-index:100;font-size:14px;display:flex;align-items:center;gap:8px}.zoom-label[data-v-988cb524]{color:#666;font-weight:500}.zoom-value[data-v-988cb524]{color:#1890ff;font-weight:600;font-size:16px}\n/*$vite$:1*/',document.head.appendChild(e);const I=[[114.30546,30.593099],[114.55,30.55],[114.87083,30.49556],[115.025,30.21333],[115.45,29.85],[115.895,29.71361],[116.25,29.85],[116.65,30.15],[117.03639,30.51611],[117.45,30.75],[117.81028,30.93917],[117.95,31.15],[118.25,31.35],[118.492839,31.678246],[118.65,31.95],[118.76556,32.06417],[119.05,32.22],[119.41611,32.21],[119.75,32.32],[120.15,32.05],[120.55,31.98],[120.85,32.02],[121.15,31.85],[121.45,31.62],[121.513867,31.656222]],A=[[73.5,18],[135,53.5]],T=[{name:"武汉港",lng:114.30546,lat:30.593099},{name:"马鞍山港",lng:118.492839,lat:31.678246},{name:"上海崇明岛港",lng:121.513867,lat:31.656222}],B=[{label:"01/15 12:00",portIndex:0},{label:"01/19 12:00",portIndex:1},{label:"01/20 12:00",portIndex:2}],R={class:"timeline-container"},S={class:"timeline-wrapper"},$=l({__name:"Timeline",props:{nodes:{},modelValue:{}},emits:["update:modelValue"],setup(a,{emit:e}){const l=a,v=e,u=a=>a>l.modelValue+1,h=a=>{u(a)||v("update:modelValue",a)},f=a=>a<l.modelValue?"finish":a===l.modelValue?"process":"wait";return(e,l)=>(p(),n("div",R,[s("div",S,[l[0]||(l[0]=s("div",{style:{width:"65px","margin-top":"-6px"}},"时间轴：",-1)),t(i(z),{current:a.modelValue,onChange:h,size:"small","progress-dot":"",class:"custom-steps"},{default:o(()=>[(p(!0),n(d,null,c(a.nodes,(a,e)=>(p(),r(i(F),{key:e,title:a.label,status:f(e),disabled:u(e),class:"clickable-step"},null,8,["title","status","disabled"]))),128))]),_:1},8,["current"])])]))}}),E=P($,[["__scopeId","data-v-89be395b"]]),L={class:"panel-header"},H={class:"panel-content"},D=l({__name:"InfoPanel",props:{title:{},type:{},closable:{type:Boolean},merged:{type:Boolean}},emits:["close"],setup:a=>(e,l)=>(p(),n("div",{class:v(["info-panel",[a.type,{merged:a.merged}]])},[s("div",L,[s("h3",null,h(a.title),1),a.closable?(p(),r(i(M),{key:0,type:"text",size:"small",class:"close-btn",onClick:l[0]||(l[0]=a=>e.$emit("close"))},{default:o(()=>[t(i(k))]),_:1})):u("",!0)]),s("div",H,[f(e.$slots,"default",{},void 0)])],2))}),V=P(D,[["__scopeId","data-v-39af6138"]]),j=["data-ready"],W=l({__name:"PortPanels",props:{currentTimeIndex:{},isReady:{type:Boolean},isSailing:{type:Boolean}},setup(a,{expose:e}){const l=m(null),i=m(null),c=m(null),r=m(null),v=m(null),h=m(null),f=m(null),g=m({wuhan:{left:!0,right:!0,sailing:!0},maanshan:{left:!0,right:!0,sailing:!0}}),b=(a,e)=>{g.value[a][e]=!1};return e({wuhanLeftPanel:l,wuhanRightPanel:i,wuhanPanel:c,maanshanLeftPanel:r,maanshanRightPanel:v,maanshanPanel:h,shanghaiPanel:f}),(e,m)=>(p(),n("div",{class:"port-panels-wrapper","data-ready":a.isReady},[a.currentTimeIndex<=1?(p(),n(d,{key:0},[0!==a.currentTimeIndex||a.isSailing?u("",!0):(p(),n(d,{key:0},[g.value.wuhan.left?(p(),n("div",{key:0,ref_key:"wuhanLeftPanelRef",ref:l,class:"single-panel wuhan-left"},[t(V,{title:"业务信息",type:"left",closable:"",onClose:m[0]||(m[0]=a=>b("wuhan","left"))},{default:o(()=>[...m[6]||(m[6]=[s("div",{class:"info-item"},[s("span",{class:"label"},"订单号："),s("span",{class:"value"},"A0001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"钢厂："),s("span",{class:"value"},"武汉钢厂")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预准发号："),s("span",{class:"value"},"A10001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预准发数量："),s("span",{class:"value"},"100T，目的地上海")],-1)])]),_:1})],512)):u("",!0),g.value.wuhan.right?(p(),n("div",{key:1,ref_key:"wuhanRightPanelRef",ref:i,class:"single-panel wuhan-right"},[t(V,{title:"物流信息",type:"right",closable:"",onClose:m[1]||(m[1]=a=>b("wuhan","right"))},{default:o(()=>[...m[7]||(m[7]=[s("div",{class:"info-item"},[s("span",{class:"label"},"船名："),s("span",{class:"value"},"武汉1号")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"吨数："),s("span",{class:"value"},"120T")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预计抵达时间："),s("span",{class:"value"},"1月16日12点")],-1)])]),_:1})],512)):u("",!0)],64)),1===a.currentTimeIndex&&a.isSailing&&g.value.wuhan.sailing?(p(),n("div",{key:1,ref_key:"wuhanPanelRef",ref:c,class:"single-panel wuhan-merged"},[t(V,{title:"航行信息",type:"merged",merged:"",closable:"",onClose:m[2]||(m[2]=a=>b("wuhan","sailing"))},{default:o(()=>[...m[8]||(m[8]=[s("div",{class:"info-item"},[s("span",{class:"label"},"排船计划号："),s("span",{class:"value"},"B0001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"船名："),s("span",{class:"value"},"武汉1号")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预计抵达时间："),s("span",{class:"value"},"1月16日12时")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预计装货吨位："),s("span",{class:"value"},"100吨")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"关联预准发号："),s("span",{class:"value"},"A10001")],-1)])]),_:1})],512)):u("",!0)],64)):u("",!0),a.currentTimeIndex>=1&&a.currentTimeIndex<=2?(p(),n(d,{key:1},[1!==a.currentTimeIndex||a.isSailing?u("",!0):(p(),n(d,{key:0},[g.value.maanshan.left?(p(),n("div",{key:0,ref_key:"maanshanLeftPanelRef",ref:r,class:"single-panel maanshan-left"},[t(V,{title:"业务信息",type:"left",closable:"",onClose:m[3]||(m[3]=a=>b("maanshan","left"))},{default:o(()=>[...m[9]||(m[9]=[s("div",{class:"info-item"},[s("span",{class:"label"},"母船批号："),s("span",{class:"value"},"C0001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"船名："),s("span",{class:"value"},"武汉1号")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"发货时间："),s("span",{class:"value"},"1月16日16时")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"装货吨位："),s("span",{class:"value"},"102吨 目的地上海")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"关联预准发号："),s("span",{class:"value"},"A10001")],-1)])]),_:1})],512)):u("",!0),g.value.maanshan.right?(p(),n("div",{key:1,ref_key:"maanshanRightPanelRef",ref:v,class:"single-panel maanshan-right"},[t(V,{title:"物流信息",type:"right",closable:"",onClose:m[4]||(m[4]=a=>b("maanshan","right"))},{default:o(()=>[...m[10]||(m[10]=[s("div",{class:"info-item"},[s("span",{class:"label"},"排船计划号："),s("span",{class:"value"},"F0001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"船名："),s("span",{class:"value"},"武汉1号")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预计抵达时间："),s("span",{class:"value"},"1月19日12时")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预计装货吨位："),s("span",{class:"value"},"300吨")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"关联预准发号："),s("span",{class:"value"},"E10001")],-1)])]),_:1})],512)):u("",!0)],64)),2===a.currentTimeIndex&&a.isSailing&&g.value.maanshan.sailing?(p(),n("div",{key:1,ref_key:"maanshanPanelRef",ref:h,class:"single-panel maanshan-merged"},[t(V,{title:"航行信息",type:"merged",merged:"",closable:"",onClose:m[5]||(m[5]=a=>b("maanshan","sailing"))},{default:o(()=>[...m[11]||(m[11]=[s("div",{class:"info-item"},[s("span",{class:"label"},"子船批号："),s("span",{class:"value"},"S001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"船名："),s("span",{class:"value"},"武汉1号")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"预计到货时间："),s("span",{class:"value"},"1月20日12点")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"装货吨位："),s("span",{class:"value"},"402吨 目的地上海")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"关联母船批号："),s("span",{class:"value"},"C0001、G0001")],-1)])]),_:1})],512)):u("",!0)],64)):u("",!0),2!==a.currentTimeIndex||a.isSailing?u("",!0):(p(),n("div",{key:2,ref_key:"shanghaiPanelRef",ref:f,class:"single-panel shanghai"},[t(V,{title:"港口信息",type:"single"},{default:o(()=>[...m[12]||(m[12]=[s("div",{class:"info-item"},[s("span",{class:"label"},"子船批号："),s("span",{class:"value"},"S001")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"船名："),s("span",{class:"value"},"武汉1号")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"卸货时间："),s("span",{class:"value"},"1月20日8点")],-1),s("div",{class:"info-item"},[s("span",{class:"label"},"港口实收库存："),s("span",{class:"value"},"402吨/15件")],-1)])]),_:1})],512))],8,j))}}),J=P(W,[["__scopeId","data-v-568c424d"]]),U={class:"map-visualization"},Z={key:0,class:"zoom-level-display"},q={class:"zoom-value"},G=l({__name:"index",setup(a){const e=m(null),l=m(null),o=m(0),d=m(!1),c=m(!1),v=m(!1),f=m(7.3),z=g(null),F=g(null),M=g(null),k=g(null);let P=null,R=null;const S=C((a,e)=>{c.value=!1,K(a,e)},100);b(o,(a,e)=>{S(a,e)});const $=()=>{R||(R=requestAnimationFrame(()=>{X(),R=null}))},L=_(()=>{X()},100),H=C(()=>{X()},200),D=()=>{z.value&&(f.value=z.value.getZoom())},V=()=>{if(window.AMap&&e.value)try{z.value=new window.AMap.Map(e.value,{center:[T[0].lng,T[0].lat],zoom:7.3,zooms:[4,18],mapStyle:"amap://styles/normal",features:["bg","point"]});const a=new window.AMap.Bounds(A[0],A[1]);z.value.setLimitBounds(a),z.value.on("mapmove",$),z.value.on("zoom",()=>{$(),D()}),z.value.on("moveend",L),z.value.on("zoomend",()=>{L(),D()}),window.addEventListener("resize",H),setTimeout(()=>{z.value&&(F.value=new window.AMap.TileLayer.Satellite,F.value.setMap(z.value),z.value.addControl(new window.AMap.ToolBar),j(),W(),G(),d.value=!0,D(),K(0,0))},200)}catch(a){console.error("地图初始化失败:",a)}},j=()=>{z.value&&T.forEach(a=>{new window.AMap.Marker({position:[a.lng,a.lat],title:a.name,map:z.value,content:'\n        <div style="position: relative;">\n          <svg viewBox="0 0 1024 1024" width="36" height="36">\n            <path d="M512 0C312.64 0 151.04 161.6 151.04 360.96c0 101.12 48.64 190.72 122.88 252.16L512 1024l238.08-410.88c74.24-61.44 122.88-151.04 122.88-252.16C872.96 161.6 711.36 0 512 0z m0 544c-100.48 0-181.76-81.28-181.76-181.76s81.28-181.76 181.76-181.76 181.76 81.28 181.76 181.76-81.28 181.76-181.76 181.76z" fill="#ff4d4f"></path>\n          </svg>\n        </div>\n      ',offset:new window.AMap.Pixel(-18,-36)})})},W=()=>{z.value&&(M.value=new window.AMap.Polyline({path:I,strokeColor:"#0088FF",strokeWeight:5,strokeStyle:"solid",map:z.value,lineJoin:"round",lineCap:"round"}))},G=()=>{z.value&&(k.value=new window.AMap.Marker({position:[T[0].lng,T[0].lat],content:'\n    <div class="custom-ship-marker" style="width: 48px; height: 48px;">\n      <svg viewBox="0 0 1024 1024" width="48" height="48" version="1.1" xmlns="http://www.w3.org/2000/svg">\n        <path d="M512 1023.38118C229.626475 1023.38118 0.61882 794.373525 0.61882 512 0.61882 229.611741 229.626475 0.61882 512 0.61882c282.373525 0 511.38118 228.992921 511.38118 511.366446 0 282.388259-229.007655 511.395914-511.38118 511.395914z" fill="#D7D7D8"></path>\n        <path d="M509.509986 207.820432h21.909179v118.062043h-21.909179zM573.955683 247.572259h21.90918v118.062043h-21.90918z" fill="#C32D2C"></path>\n        <path d="M633.480288 341.014101h-134.342907c-2.711022 0-4.90636-2.195338-4.906359-4.90636v-20.450532c0-2.711022 2.195338-4.90636 4.906359-4.90636h134.342907c2.711022 0 4.90636 2.195338 4.906359 4.90636v20.450532c0 2.711022-2.195338 4.90636-4.906359 4.90636z" fill="#E74A48"></path>\n        <path d="M494.231022 337.271712h144.155625v219.975828h-144.155625zM356.602475 417.394187h-70.692835c-12.243799 0-22.174388 9.93059-22.174388 22.174389v88.005064c0 12.243799 9.93059 22.174388 22.174388 22.174389h70.692835c12.243799 0 22.174388-9.93059 22.174388-22.174389v-88.005064c0-12.243799-9.93059-22.174388-22.174388-22.174389z" fill="#FFD599"></path>\n        <path d="M680.142273 535.14682H219.504345a10.269468 10.269468 0 0 0-10.269467 10.269468v128.817726a10.269468 10.269468 0 0 0 10.269467 10.269468h460.637928a10.269468 10.269468 0 0 0 10.269468-10.269468v-128.817726a10.269468 10.269468 0 0 0-10.269468-10.269468z" fill="#E74A48"></path>\n        <path d="M249.458187 574.456633h44.982331v35.31695h-44.982331z" fill="#96D7FF"></path>\n        <path d="M294.440518 574.456633v35.31695h-44.982331v-35.31695h44.982331m2.16587-2.16587H247.262849v39.678158H296.606388v-39.678158z" fill="#FFFFFF"></path>\n        <path d="M290.712863 550.396317l-6.497611-8.162533-40.901065 69.853007 6.512345 8.162533zM300.55505 562.728518l-6.497611-8.162532-40.901065 69.853007 6.512345 8.162532z" fill="#B5E3FF"></path>\n        <path d="M345.714187 574.456633h44.982331v35.31695h-44.982331z" fill="#96D7FF"></path>\n        <path d="M390.696518 574.456633v35.31695h-44.982331v-35.31695h44.982331m2.180604-2.16587H343.533583v39.678158H392.877122v-39.678158z" fill="#FFFFFF"></path>\n        <path d="M386.983597 550.396317l-6.512345-8.162533-40.886331 69.853007 6.497611 8.162533zM396.825784 562.728518l-6.512345-8.162532-40.886331 69.853007 6.497611 8.162532z" fill="#B5E3FF"></path>\n        <path d="M441.984921 574.456633h44.982331v35.31695h-44.982331z" fill="#96D7FF"></path>\n        <path d="M486.952518 574.456633v35.31695h-44.982331v-35.31695h44.982331m2.180604-2.16587H439.789583v39.678158H489.133122v-39.678158z" fill="#FFFFFF"></path>\n        <path d="M483.239597 550.396317l-6.512345-8.162533-40.886331 69.853007 6.512345 8.162533zM493.081784 562.728518l-6.512345-8.162532-40.886331 69.853007 6.512345 8.162532z" fill="#B5E3FF"></path>\n        <path d="M538.240921 574.456633h44.982331v35.31695h-44.982331z" fill="#96D7FF"></path>\n        <path d="M583.223252 574.456633v35.31695h-44.982331v-35.31695h44.982331m2.16587-2.16587H536.045583v39.678158H585.389122v-39.678158z" fill="#FFFFFF"></path>\n        <path d="M579.495597 550.396317l-6.497611-8.162533-40.901065 69.853007 6.512345 8.162533zM589.337784 562.728518l-6.497611-8.162532-40.901065 69.853007 6.512345 8.162532z" fill="#B5E3FF"></path>\n        <path d="M762.725295 787.036086l-12.951022 29.143482H324.276489c-33.254216 0-64.003683-10.814619-88.87436-29.143482h527.323166z" fill="#A42124"></path>\n        <path d="M849.875799 605.39764l-87.150504 181.638446h-527.323166c-37.158676-25.312691-61.277928-66.095885-61.277928-112.094849h346.80449l96.550676-69.543597h232.396432z" fill="#C32D2C"></path>\n        <path d="M717.949237 774.497612h-60.349697l23.515165-55.914821-34.919137 55.914821h-60.511769l23.515165-55.914821-34.904403 55.914821H513.768058l23.515165-55.914821-34.904403 55.914821H441.86705l23.515166-55.914821-34.757065 55.67908-26.167252-20.332662 20.391597 33.254215h300.481382l47.236604-114.894273-54.618245 102.208461z" fill="#DA4C3C"></path>\n        <path d="M394.114763 722.457784h-159.272518a9.444374 9.444374 0 0 1 0-18.888748h159.272518a9.444374 9.444374 0 0 1 0 18.888748z" fill="#F7CF6F"></path>\n      </svg>\n    </div>\n',map:z.value,offset:new window.AMap.Pixel(-24,-24),zIndex:200}),console.log("船只 Marker 初始化完成:",k.value))},K=(a,e=0)=>{if(!z.value)return;const l=T[B[a].portIndex];z.value.setCenter([l.lng,l.lat]),z.value.setZoom(7.3),Q(a,e),setTimeout(async()=>{await y(),X(),await y(),v.value||(c.value=!0)},300)},N=(a=-1)=>{if(!z.value)return;M.value&&(Array.isArray(M.value)?M.value.forEach(a=>a.setMap(null)):M.value.setMap(null));let e=a;if(-1===e){const a=B[o.value].portIndex;0===a?e=0:1===a?e=13:2===a&&(e=I.length-1)}const l=I.slice(0,e+1),n=new window.AMap.Polyline({path:l,strokeColor:"#B71C1C",strokeWeight:5,strokeStyle:"dashed",map:z.value,lineJoin:"round",lineCap:"round",zIndex:50}),s=I.slice(e),t=new window.AMap.Polyline({path:s,strokeColor:"#0088FF",strokeWeight:5,strokeStyle:"solid",map:z.value,lineJoin:"round",lineCap:"round",zIndex:40});M.value=[n,t]},O=a=>0===a?0:1===a?13:2===a?I.length-1:0,Q=(a,e)=>{if(!k.value)return void console.log("shipMarker 不存在");P&&(clearInterval(P),P=null);const l=B[e].portIndex,n=B[a].portIndex,s=O(l),t=O(n);let i;if(N(s),console.log(`更新船只位置：从节点 ${e} 到 ${a}，路径索引从 ${s} 到 ${t}`),i=s<=t?I.slice(s,t+1):[I[t]],console.log("targetPath 长度:",i.length),i.length<=1)return console.log("路径只有一个点，直接设置位置:",i[0]),k.value.setPosition(i[0]),void(v.value=!1);v.value=!0,y(()=>{X(),c.value=!0});let o=0;const p=i.length-1,d=5e3/p;console.log("开始船只动画，总步数:",p,"间隔:",d,"ms"),k.value.setPosition(i[0]),console.log("船只初始位置设置为:",i[0]),P=window.setInterval(()=>{if(o++,o>=i.length)return console.log("船只动画完成，到达终点"),v.value=!1,k.value&&k.value.setAngle&&k.value.setAngle(0),setTimeout(async()=>{await y(),X(),await y(),c.value=!0},50),void(P&&(clearInterval(P),P=null));const a=i[o];if(k.value&&k.value.setPosition){if(k.value.setPosition(a),N(s+o),X(),o%10==0&&console.log(`船只移动到第 ${o}/${i.length} 个点:`,a),o>0&&k.value.setAngle){const e=i[o-1],l=180*Math.atan2(a[1]-e[1],a[0]-e[0])/Math.PI;k.value.setAngle(l)}}else console.error("船只 Marker 或 setPosition 方法不存在"),P&&(clearInterval(P),P=null)},d)},X=()=>{if(!z.value||!l.value)return;const{wuhanLeftPanel:a,wuhanRightPanel:e,wuhanPanel:n,maanshanLeftPanel:s,maanshanRightPanel:t,maanshanPanel:i,shanghaiPanel:p}=l.value,d=(a,e)=>{if(a){const l=T[e],n=z.value.lngLatToContainer([l.lng,l.lat]);a.style.transform=`translate(${n.x-240}px, ${n.y-80}px)`}},c=(a,e)=>{if(a){const l=T[e],n=z.value.lngLatToContainer([l.lng,l.lat]);a.style.transform=`translate(${n.x+50}px, ${n.y-80}px)`}},r=(a,e,l=!1)=>{if(a){let n;if(l&&k.value){const a=k.value.getPosition();n=[a.lng,a.lat]}else{const a=T[e];n=[a.lng,a.lat]}const s=z.value.lngLatToContainer(n),t=l?-220:-200;a.style.transform=`translate(${s.x-120}px, ${s.y+t}px)`}};d(a,0),c(e,0),r(n,0,v.value&&1===o.value),d(s,1),c(t,1),r(i,1,v.value&&2===o.value),r(p,2)};return w(()=>{(()=>{if(!e.value)return;if(window.AMap)return void V();const a="amap-script";if(document.getElementById(a))return;const l=document.createElement("script");l.id=a,l.src="https://webapi.amap.com/maps?v=2.0&key=8940d994cb3eeea3ae13fb33c34c0fd9&plugin=AMap.ToolBar",l.onload=()=>{V()},document.body.appendChild(l)})()}),x(()=>{R&&cancelAnimationFrame(R),P&&clearInterval(P),window.removeEventListener("resize",H),S.cancel(),L.cancel(),H.cancel(),z.value&&z.value.destroy()}),(a,m)=>(p(),n("div",U,[s("div",{ref_key:"mapContainer",ref:e,class:"map-container"},null,512),d.value?(p(),n("div",Z,[m[1]||(m[1]=s("span",{class:"zoom-label"},"缩放级别:",-1)),s("span",q,h(f.value.toFixed(1)),1)])):u("",!0),t(E,{nodes:i(B),modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=a=>o.value=a)},null,8,["nodes","modelValue"]),d.value?(p(),r(J,{key:1,ref_key:"portPanelsRef",ref:l,"current-time-index":o.value,"is-ready":c.value,"is-sailing":v.value},null,8,["current-time-index","is-ready","is-sailing"])):u("",!0)]))}});a("default",P(G,[["__scopeId","data-v-988cb524"]]))}}});
