import{_ as W}from"./_plugin-vue_export-helper-BT4imNYs.js";import{o as x}from"./order-BeT2V7Ur.js";import{d as j,f as C,r as h,o as H,_ as N,k as o,W as a,U as l,V as m,G as n,S as y,a2 as b,a3 as S,u as J,$ as K}from"./vue-vendor-DGayM9PE.js";import{h as k,m as Q,n as X}from"./ant-design-Ce2DOam0.js";import"./utils-BsVK5D5E.js";const Y={class:"order-page"},Z={key:1},tt=j({__name:"index",setup(et){const f=K(),g=C(!1),v=C([]),r=h({status:void 0,customerName:void 0}),s=h({current:1,pageSize:10,total:0,showSizeChanger:!0,showTotal:e=>"共 ".concat(e," 条")}),z=[{title:"订单编号",dataIndex:"id",key:"id",width:150},{title:"客户名称",dataIndex:"customerName",key:"customerName",width:200},{title:"产品名称",dataIndex:"productName",key:"productName",width:150},{title:"数量",key:"quantity",width:120,customRender:({record:e})=>"".concat(e.quantity," ").concat(e.unit)},{title:"总金额",key:"totalAmount",width:150},{title:"状态",key:"status",width:120},{title:"下单日期",dataIndex:"orderDate",key:"orderDate",width:120},{title:"交货日期",dataIndex:"deliveryDate",key:"deliveryDate",width:120},{title:"操作",key:"action",width:200,fixed:"right"}];async function c(){g.value=!0;try{const e={page:s.current,pageSize:s.pageSize,status:r.status,customerName:r.customerName},t=await x.getOrders(e);t.code===200&&(v.value=t.data.list,s.total=t.data.total)}catch(e){console.error("获取订单列表失败",e),k.error("获取订单列表失败")}finally{g.value=!1}}function $(){s.current=1,c()}function D(){r.status=void 0,r.customerName=void 0,s.current=1,c()}function I(e){s.current=e.current,s.pageSize=e.pageSize,c()}function M(){f.push("/order/create")}function O(e){f.push("/order/detail/".concat(e.id))}function T(e){f.push("/tracking/".concat(e.id))}function V(e){X.confirm({title:"确认取消",content:"确定要取消订单 ".concat(e.id," 吗？"),onOk:async()=>{try{(await x.cancelOrder(e.id)).code===200&&(k.success("取消成功"),c())}catch(t){console.error("取消订单失败",t),k.error("取消订单失败")}}})}function A(e){return{pending:"default",confirmed:"blue",producing:"processing",warehousing:"orange",transporting:"cyan",shipped:"purple",completed:"success",cancelled:"error"}[e]||"default"}function B(e){return{pending:"待确认",confirmed:"已确认",producing:"生产中",warehousing:"集货中",transporting:"运输中",shipped:"已发货",completed:"已完成",cancelled:"已取消"}[e]||e}function F(e){return e.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})}return H(()=>{c()}),(e,t)=>{const p=l("a-button"),i=l("a-select-option"),R=l("a-select"),_=l("a-form-item"),U=l("a-input"),q=l("a-form"),E=l("a-tag"),G=l("a-space"),L=l("a-table"),P=l("a-card");return m(),N("div",Y,[o(P,{title:"订单管理",bordered:!1},{extra:a(()=>[o(p,{type:"primary",onClick:M},{icon:a(()=>[o(J(Q))]),default:a(()=>[t[2]||(t[2]=n(" 新建订单 ",-1))]),_:1})]),default:a(()=>[o(q,{layout:"inline",model:r,class:"search-form"},{default:a(()=>[o(_,{label:"订单状态"},{default:a(()=>[o(R,{value:r.status,"onUpdate:value":t[0]||(t[0]=u=>r.status=u),placeholder:"请选择状态","allow-clear":"",style:{width:"150px"}},{default:a(()=>[o(i,{value:"pending"},{default:a(()=>[...t[3]||(t[3]=[n("待确认",-1)])]),_:1}),o(i,{value:"confirmed"},{default:a(()=>[...t[4]||(t[4]=[n("已确认",-1)])]),_:1}),o(i,{value:"producing"},{default:a(()=>[...t[5]||(t[5]=[n("生产中",-1)])]),_:1}),o(i,{value:"warehousing"},{default:a(()=>[...t[6]||(t[6]=[n("集货中",-1)])]),_:1}),o(i,{value:"transporting"},{default:a(()=>[...t[7]||(t[7]=[n("运输中",-1)])]),_:1}),o(i,{value:"shipped"},{default:a(()=>[...t[8]||(t[8]=[n("已发货",-1)])]),_:1}),o(i,{value:"completed"},{default:a(()=>[...t[9]||(t[9]=[n("已完成",-1)])]),_:1})]),_:1},8,["value"])]),_:1}),o(_,{label:"客户名称"},{default:a(()=>[o(U,{value:r.customerName,"onUpdate:value":t[1]||(t[1]=u=>r.customerName=u),placeholder:"请输入客户名称","allow-clear":""},null,8,["value"])]),_:1}),o(_,null,{default:a(()=>[o(p,{type:"primary",onClick:$},{default:a(()=>[...t[10]||(t[10]=[n("查询",-1)])]),_:1}),o(p,{style:{"margin-left":"8px"},onClick:D},{default:a(()=>[...t[11]||(t[11]=[n("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),o(L,{columns:z,"data-source":v.value,loading:g.value,pagination:s,onChange:I,"row-key":"id",style:{"margin-top":"16px"}},{bodyCell:a(({column:u,record:d})=>[u.key==="status"?(m(),y(E,{key:0,color:A(d.status)},{default:a(()=>[n(S(B(d.status)),1)]),_:2},1032,["color"])):u.key==="totalAmount"?(m(),N("span",Z,"¥"+S(F(d.totalAmount)),1)):u.key==="action"?(m(),y(G,{key:2},{default:a(()=>[o(p,{type:"link",size:"small",onClick:w=>O(d)},{default:a(()=>[...t[12]||(t[12]=[n("查看",-1)])]),_:1},8,["onClick"]),o(p,{type:"link",size:"small",onClick:w=>T(d)},{default:a(()=>[...t[13]||(t[13]=[n("追踪",-1)])]),_:1},8,["onClick"]),d.status==="pending"?(m(),y(p,{key:0,type:"link",size:"small",danger:"",onClick:w=>V(d)},{default:a(()=>[...t[14]||(t[14]=[n(" 取消 ",-1)])]),_:1},8,["onClick"])):b("",!0)]),_:2},1024)):b("",!0)]),_:1},8,["data-source","loading","pagination"])]),_:1})])}}}),st=W(tt,[["__scopeId","data-v-4e0fb827"]]);export{st as default};
